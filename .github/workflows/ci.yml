name: GPU Monitor CI

on:
  push:
    branches: [ main ]

jobs:
  main-checks:
    runs-on: ubuntu-latest

    steps:
      - name: üì• Checkout –∫–æ–¥–∞
        uses: actions/checkout@v3

      - name: ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞ shellcheck'–æ–º
        run: |
          sudo apt update && sudo apt install -y shellcheck
          shellcheck scripts/temp_cont.sh

      - name: üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ crontab-linter
        run: |
          curl -sL https://raw.githubusercontent.com/krutoo/crontab-linter/master/crontab-linter.sh -o crontab-linter.sh
          chmod +x crontab-linter.sh

      - name: ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è cron
        run: |
          ./crontab-linter.sh "*/10 * * * * /usr/local/bin/temp_cont.sh"

      - name: üß™ –ú–æ–∫ nvidia-smi –∏ —Ç–µ—Å—Ç —Å–∫—Ä–∏–ø—Ç–∞
        run: |
          chmod +x scripts/temp_cont.sh
          ./scripts/temp_cont.sh || echo "–°–∫—Ä–∏–ø—Ç —Å—Ä–∞–±–æ—Ç–∞–ª –∫–∞–∫ –æ–∂–∏–¥–∞–ª–æ—Å—å –ø—Ä–∏ –ø–µ—Ä–µ–≥—Ä–µ–≤–µ"

